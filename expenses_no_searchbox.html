<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>××œ×•× ×•×ª ×•×”×•×¦××•×ª</title>
  <style>
    :root {
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
      --good:#22c55e;
      --good-bg: rgba(34,197,94,.12);
      --danger:#ef4444;
      --chip:#eef2ff;
      --shadow: 0 10px 24px rgba(0,0,0,.08);
      --radius: 18px;
    }
    [data-theme="dark"] {
      --bg:#0b0f14;
      --card:#111827;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --border:#1f2a3a;
      --good:#22c55e;
      --good-bg: rgba(34,197,94,.14);
      --danger:#f87171;
      --chip:#172554;
      --shadow: 0 18px 40px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
    a{color:inherit}
    .wrap{max-width:900px;margin:0 auto;padding:14px 14px 60px;}
    header{position:sticky;top:0;background:linear-gradient(to bottom, var(--bg) 70%, rgba(0,0,0,0));backdrop-filter:saturate(140%) blur(6px);padding-top:10px;z-index:5;}
    .topbar{display:flex;justify-content:space-between;gap:12px;align-items:flex-start;}
    h1{font-size:22px;margin:0;}
    .subtitle{margin-top:4px;color:var(--muted);font-size:13px;}
    .actions{display:flex;gap:8px;align-items:center;}
    .btn{border:1px solid var(--border);background:var(--card);color:var(--text);padding:10px 12px;border-radius:12px;font-weight:800;font-size:14px;box-shadow:var(--shadow);}
    .btn:active{transform:translateY(1px);}
    .btn-danger{border-color:transparent;background:rgba(239,68,68,.15);color:var(--text);}
    .btn-primary{border-color:transparent;background:rgba(37,99,235,.18);color:var(--text);}
    /* Tabs */
    .tabs{display:flex;gap:8px;margin:10px 0 14px;flex-wrap:wrap;}
    .tab{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:var(--card);text-decoration:none;color:var(--text);font-weight:900;font-size:14px;line-height:1;}
    .tab.active{background:var(--chip);border-color:transparent;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:12px;box-shadow:var(--shadow);}
    .row{display:grid;grid-template-columns:1.1fr 1fr;gap:10px;}
    @media (max-width:520px){ .row{grid-template-columns:1fr;} }
    label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px;font-weight:800;}
    input{width:100%;padding:11px 12px;border-radius:12px;border:1px solid var(--border);background:transparent;color:var(--text);font-size:16px;}
    .toolbar{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap;}
    .small{color:var(--muted);font-size:13px;}
    .list{display:flex;flex-direction:column;gap:10px;margin-top:12px;}
    .stay{padding:12px;border-radius:16px;border:1px solid var(--border);background:var(--card);box-shadow:var(--shadow);}
    .stay.done{border-color:rgba(34,197,94,.35);background:linear-gradient(to left, var(--good-bg), var(--card));}
    .stayHead{display:flex;justify-content:space-between;gap:10px;align-items:flex-start;}
    .stayTitle{font-weight:1000;font-size:16px;}
    .meta{margin-top:6px;display:flex;flex-wrap:wrap;gap:8px;}
    .pill{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);color:var(--muted);}
    .pill.strong{color:var(--text);}
    .stayActions{display:flex;gap:8px;align-items:center;}
    .iconBtn{border:1px solid var(--border);background:transparent;color:var(--text);padding:8px 10px;border-radius:12px;font-weight:900;}
    .iconBtn:active{transform:translateY(1px);}
    .check{display:flex;gap:8px;align-items:center;margin-top:10px;}
    .check input{width:22px;height:22px;}
    .search{margin-top:12px;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="topbar">
        <div>
          <h1>ğŸ¨ ××œ×•× ×•×ª ×•×”×•×¦××•×ª</h1>
          <div class="subtitle">×¨×©×™××” ×œ×¤×™ ×”×§×•×‘×¥ â€¢ ××¤×©×¨ ×œ×”×•×¡×™×£/×œ××—×•×§ â€¢ × ×©××¨ ××•×˜×•××˜×™×ª</div>
        </div>
        <div class="actions">
          <button id="themeBtn" class="btn" title="××¦×‘ ×‘×”×™×¨/×›×”×”">â˜€ï¸</button>
          <button id="resetBtn" class="btn btn-danger" title="××™×¤×•×¡">××™×¤×•×¡</button>
        </div>
      </div>

      <nav class="tabs" aria-label="× ×™×•×•×˜">
        <a class="tab" href="packing_v3.html">ğŸ’ Packing</a>
        <a class="tab active" href="expenses.html">ğŸ’° ××œ×•× ×•×ª / ×‘×™×˜×•×œ ×—×™× ×</a>
      </nav>

      <div class="toolbar">
        <button id="addBtn" class="btn btn-primary">â• ×”×•×¡×£ ××œ×•×Ÿ</button>
        <div class="small" id="stats"></div>
      </div>
</header>

    <div class="list" id="list"></div>
  </div>

<script>
  const STORAGE_KEY = "expensesData_v1";
  const THEME_KEY = "packing_app_v3_theme";
  const DEFAULT = [{"id": "s1", "hotel": "×©×× ×˜×™", "location": "×§×•×“×• ×‘×™×¥'", "start": "31.12", "end": "31.12", "cancel": "", "cost": 400.0}, {"id": "s2", "hotel": "×©×× ×˜×™", "location": "×¤×•×§×˜", "start": "01.10", "end": "01.10", "cancel": "", "cost": null}, {"id": "s3", "hotel": "Phi Phi Natural Resort", "location": "×§×•×¤×™×¤×™", "start": "02.10", "end": "03.10", "cancel": "×‘×™×˜×•×œ ×¢×“ 15 ×“×¦××‘×¨", "cost": 1130.0}, {"id": "s4", "hotel": "monkey hub", "location": "×§×¨××‘×™", "start": "04.10", "end": "05.10", "cancel": "×‘×™×˜×•×œ ×¢×“ ×” 28 ×‘×“×¦××‘×¨", "cost": 530.0}, {"id": "s5", "hotel": "Bananas Resort & Restaurant", "location": "×§×¨××‘×™", "start": "06.10", "end": "06.10", "cancel": "×‘×™×˜×•×œ ×¢×“ ×” 23 ×‘×“×¦××‘×¨", "cost": 120.0}, {"id": "s6", "hotel": "PAN Beachfront Resort Krabi", "location": "×§×¨××‘×™", "start": "07.10", "end": "08.10", "cancel": "×‘×™×˜×•×œ ×¢×“ ×” 24 ×‘×“×¦××‘×¨", "cost": 775.0}, {"id": "s7", "hotel": "koh phaluai beach cottage", "location": "×§×• ×¤×œ×•×™", "start": "09.10", "end": "10.10", "cancel": "×‘×™×˜×•×œ ×¢×“ ×” 3 ×‘×™× ×•××¨", "cost": 407.0}, {"id": "s8", "hotel": "Felix River Kwai Resort", "location": "×§× ×¦× ×‘×•×¨×™", "start": "11.10", "end": "13.10", "cancel": "×‘×™×˜×•×œ ×¢×“ ×” 9 ×œ×™× ×•××¨", "cost": 700.0}, {"id": "s9", "hotel": "The Xcape River Kwai", "location": "×§× ×¦× ×‘×•×¨×™", "start": "14.10", "end": "15.10", "cancel": "×‘×™×˜×•×— ×¢×“ ×” 6 ×œ×™× ×•××¨", "cost": 1600.0}, {"id": "s10", "hotel": "Diff Apartel Banglamphu", "location": "×‘× ×’×§×•×§", "start": "16.10", "end": "18.10", "cancel": "×‘×™×˜×•×œ ×¢×“  ×”13\\×‘×™× ×•××¨", "cost": 850.0}, {"id": "s11", "hotel": "Island Escape Burasari", "location": "×‘× ×’×§×•×§", "start": "19.10", "end": "19.10", "cancel": "×¢×“ ×” 3 ×‘×™× ×•××¨", "cost": 777.0}, {"id": "s12", "hotel": "Island Escape Burasari", "location": "×¤×•×§×˜ (×˜×™×¡×” ×—×–×•×¨ ×‘14:35", "start": "20.10", "end": "20.10", "cancel": "", "cost": null}];

  function uid() {
    return "x" + Math.random().toString(16).slice(2) + Date.now().toString(16);
  }

  function loadData() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return DEFAULT;
      const parsed = JSON.parse(raw);
      if (!Array.isArray(parsed)) return DEFAULT;
      return parsed;
    } catch (e) {
      return DEFAULT;
    }
  }

  function saveData(data) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  }

  function applyTheme(theme) {
    document.documentElement.setAttribute("data-theme", theme);
    document.getElementById("themeBtn").textContent = theme === "dark" ? "ğŸŒ™" : "â˜€ï¸";
  }

  function loadTheme() {
    const t = localStorage.getItem(THEME_KEY) || "light";
    applyTheme(t);
  }

  function toggleTheme() {
    const current = document.documentElement.getAttribute("data-theme") || "light";
    const next = current === "dark" ? "light" : "dark";
    localStorage.setItem(THEME_KEY, next);
    applyTheme(next);
  }

  let data = loadData();

  function fmtCost(v) {
    if (v === null || v === undefined || v === "") return "";
    const n = Number(v);
    if (!Number.isFinite(n)) return String(v);
    return n.toLocaleString("he-IL");
  }

  function render() {
    const q = ""; // ×—×™×¤×•×© ×”×•×¡×¨
    const list = document.getElementById("list");
    list.innerHTML = "";
    const filtered = data.filter(s => {
      const hay = `${s.hotel||""} ${s.location||""} ${s.cancel||""} ${s.start||""} ${s.end||""}`.toLowerCase();
      return !q || hay.includes(q);
    });

    document.getElementById("stats").textContent = `${filtered.length} ×¨×©×•××•×ª â€¢ ×¡×”×´×›: ${fmtCost(filtered.reduce((a,x)=>a+(Number(x.cost)||0),0))}`;

    for (const s of filtered) {
      const div = document.createElement("div");
      div.className = "stay" + (s.paid ? " done" : "");
      div.innerHTML = `
        <div class="stayHead">
          <div>
            <div class="stayTitle">${escapeHtml(s.hotel || "×œ×œ× ×©×")}</div>
            <div class="meta">
              <span class="pill strong">ğŸ“ ${escapeHtml(s.location || "â€”")}</span>
              <span class="pill">ğŸ“… ${escapeHtml((s.start||"") + (s.end?("â€“"+s.end):""))}</span>
              <span class="pill">ğŸ’¸ ${escapeHtml(fmtCost(s.cost) || "â€”")}</span>
              <span class="pill">ğŸ†“ ${escapeHtml(s.cancel || "â€”")}</span>
            </div>
            <div class="check">
              <input type="checkbox"  id="paid_${s.id}"   >
              <span class="small">×¡×•××Ÿ ×›×©×•×œ× / ×¡×’×•×¨</span>
            </div>
          </div>
          <div class="stayActions">
            <button class="iconBtn" data-act="edit" data-id="${s.id}" title="×¢×¨×™×›×”">âœï¸</button>
            <button class="iconBtn" data-act="del" data-id="${s.id}" title="××—×™×§×”">ğŸ—‘ï¸</button>
          </div>
        </div>
      `;
      list.appendChild(div);
      const cb = div.querySelector(`#paid_${s.id}`);
      cb.checked = !!s.paid;
      cb.addEventListener("change", () => {
        const idx = data.findIndex(x => x.id === s.id);
        if (idx >= 0) {
          data[idx].paid = cb.checked;
          saveData(data);
          render();
        }
      });
      div.addEventListener("click", (e) => {
        const btn = e.target.closest("button[data-act]");
        if (!btn) return;
        const id = btn.getAttribute("data-id");
        const act = btn.getAttribute("data-act");
        if (act === "del") {
          if (confirm("×œ××—×•×§ ××ª ×”×¨×©×•××”?")) {
            data = data.filter(x => x.id !== id);
            saveData(data);
            render();
          }
        } else if (act === "edit") {
          const s0 = data.find(x => x.id === id);
          if (!s0) return;
          const hotel = prompt("×©× ××œ×•×Ÿ", s0.hotel || "");
          if (hotel === null) return;
          const location = prompt("××™×§×•×", s0.location || "");
          if (location === null) return;
          const start = prompt("××ª××¨×™×š (×œ×“×•×’××” 02.10)", s0.start || "");
          if (start === null) return;
          const end = prompt("×¢×“ ×ª××¨×™×š (×œ×“×•×’××” 03.10)", s0.end || "");
          if (end === null) return;
          const cancel = prompt("×‘×™×˜×•×œ ×—×™× × / ×”×¢×¨×”", s0.cancel || "");
          if (cancel === null) return;
          const cost = prompt("×¢×œ×•×ª (××¡×¤×¨)", (s0.cost ?? "").toString());
          if (cost === null) return;
          s0.hotel = hotel.trim();
          s0.location = location.trim();
          s0.start = start.trim();
          s0.end = end.trim();
          s0.cancel = cancel.trim();
          s0.cost = cost.trim()==="" ? null : Number(cost.replace(/,/g,""));
          saveData(data);
          render();
        }
      }, true);
    }
  }

  function escapeHtml(str) {
    return String(str).replace(/[&<>"']/g, s => ({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[s]);
  }

  function addStay() {
    const hotel = (prompt("×©× ××œ×•×Ÿ?") || "").trim();
    if (!hotel) return;

    const location = (prompt("××™×§×•×? (××•×¤×¦×™×•× ×œ×™)") || "").trim();
    const start = (prompt("××ª××¨×™×š? (××•×¤×¦×™×•× ×œ×™, ×œ××©×œ 02.10)") || "").trim();
    const end = (prompt("×¢×“ ×ª××¨×™×š? (××•×¤×¦×™×•× ×œ×™, ×œ××©×œ 03.10)") || "").trim();
    const cancel = (prompt("×¢×“ ××ª×™ ×‘×™×˜×•×œ ×—×™× × / ×”×¢×¨×”? (××•×¤×¦×™×•× ×œ×™)") || "").trim();
    const costRaw = (prompt("×¢×œ×•×ª? (××¡×¤×¨, ××•×¤×¦×™×•× ×œ×™)") || "").trim();
    const cost = costRaw ? Number(costRaw.replace(/,/g,"")) : null;

    data.unshift({ id: uid(), hotel, location, start, end, cancel, cost, paid:false });
    saveData(data);
    render();
  }

  document.getElementById("addBtn").addEventListener("click", addStay);
document.getElementById("themeBtn").addEventListener("click", toggleTheme);
  document.getElementById("resetBtn").addEventListener("click", () => {
    if (!confirm("×œ××¤×¡ ××ª ×”×¨×©×™××” ×œ×’×¨×¡×” ×”××§×•×¨×™×ª ××”×§×•×‘×¥? (×–×” ×™××—×§ ×’× ×ª×•×¡×¤×•×ª ×©×œ×š)")) return;
    data = DEFAULT.map(x => ({...x, paid:false}));
    saveData(data);
    render();
  });

  loadTheme();
  render();
</script>
</body>
</html>
